<div class="ui-help-container">
  <div class="ui-help-header">
    <h1>{{ pageTitle() }}</h1>
    <p class="text-secondary">{{ pageDescription() }}</p>
  </div>

  <div class="ui-help-content">
    <!-- Section 1: Technical Interface -->
    <div class="ui-help-section">
      <div class="section-header">
        <button class="collapse-toggle" (click)="toggleSection1()">
          <av-icon
            [type]="isSection1Visible() ? 'arrows/av_chevron-up' : 'arrows/av_chevron-down'"
            [size]="20"
          ></av-icon>
        </button>
        <h2>{{ section1Title() }}</h2>
      </div>
      @if (isSection1Visible()) {
      <div class="section-content">
        <div class="content-block no-style">
          <av-help-copy-container
            [title]="section1Title()"
            [content]="section1Content()"
            [bgColor]="section1BgColor()"
            [showHelpButton]="true"
            [helpContent]="section1HelpContent()"
          ></av-help-copy-container>
        </div>
      </div>
      }
    </div>

    <!-- Section 2: Playground -->
    <div class="ui-help-section">
      <div class="section-header">
        <button class="collapse-toggle" (click)="toggleSection2()">
          <av-icon
            [type]="isSection2Visible() ? 'arrows/av_chevron-up' : 'arrows/av_chevron-down'"
            [size]="20"
          ></av-icon>
        </button>
        <h2>{{ section2Title() }}</h2>
      </div>
      @if (isSection2Visible()) {
      <div class="playground-container">
        <div nz-row [nzGutter]="[24, 24]">
          <!-- Left: Controls -->
          <div nz-col [nzXs]="24" [nzLg]="12">
            <nz-card nzTitle="Настройки" [nzExtra]="resetTpl" class="control-card">
              <ng-template #resetTpl>
                <button av-button avType="text" avTextColor="#f43f5e" (click)="resetAllSettings()">Сбросить всё</button>
              </ng-template>

              <div class="control-panel-grid">
                <!-- Основные настройки -->
                <av-field-group label="Основные" [collapsible]="true">
                  <div nz-row [nzGutter]="16">
                    <div nz-col [nzSpan]="12">
                      <div class="control-item">
                        <label>Тип (avType):</label>
                        <nz-select [ngModel]="pgType()" (ngModelChange)="pgType.set($event)" style="width: 100%">
                          <nz-option nzValue="primary" nzLabel="Primary"></nz-option>
                          <nz-option nzValue="default" nzLabel="Default"></nz-option>
                          <nz-option nzValue="dashed" nzLabel="Dashed"></nz-option>
                          <nz-option nzValue="text" nzLabel="Text"></nz-option>
                          <nz-option nzValue="link" nzLabel="Link"></nz-option>
                          <nz-option nzValue="danger" nzLabel="Danger"></nz-option>
                        </nz-select>
                      </div>
                    </div>
                    <div nz-col [nzSpan]="12">
                      <div class="control-item">
                        <label>Размер (avSize):</label>
                        <nz-select [ngModel]="pgSize()" (ngModelChange)="pgSize.set($event)" style="width: 100%">
                          <nz-option nzValue="small" nzLabel="Small"></nz-option>
                          <nz-option nzValue="default" nzLabel="Default"></nz-option>
                          <nz-option nzValue="large" nzLabel="Large"></nz-option>
                          <nz-option nzValue="square" nzLabel="Square"></nz-option>
                          <nz-option nzValue="custom" nzLabel="Custom"></nz-option>
                        </nz-select>
                      </div>
                    </div>
                  </div>

                  <div class="control-item">
                    <label>Форма (avShape):</label>
                    <nz-select [ngModel]="pgShape()" (ngModelChange)="pgShape.set($event)" style="width: 100%">
                      <nz-option nzValue="default" nzLabel="Default"></nz-option>
                      <nz-option nzValue="rounded" nzLabel="Rounded"></nz-option>
                      <nz-option nzValue="rounded-big" nzLabel="Rounded Big"></nz-option>
                      <nz-option nzValue="round" nzLabel="Round (Pill)"></nz-option>
                      <nz-option nzValue="circle" nzLabel="Circle"></nz-option>
                      <nz-option nzValue="square" nzLabel="Square"></nz-option>
                    </nz-select>
                  </div>

                  <div class="control-item">
                    <label>Текст кнопки:</label>
                    <input nz-input [ngModel]="pgLabel()" (ngModelChange)="pgLabel.set($event)" placeholder="Label" />
                  </div>
                </av-field-group>

                <!-- Состояние -->
                <av-field-group label="Состояние" [collapsible]="true">
                  <div style="display: flex; gap: 24px; padding-top: 8px">
                    <div style="display: flex; align-items: center; gap: 8px">
                      <nz-switch [ngModel]="pgLoading()" (ngModelChange)="pgLoading.set($event)"></nz-switch>
                      <span style="font-size: 13px">Loading</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px">
                      <nz-switch [ngModel]="pgBlock()" (ngModelChange)="pgBlock.set($event)"></nz-switch>
                      <span style="font-size: 13px">Block</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px">
                      <nz-switch [ngModel]="pgVisible()" (ngModelChange)="pgVisible.set($event)"></nz-switch>
                      <span style="font-size: 13px">Visible</span>
                    </div>
                  </div>
                </av-field-group>

                <!-- Цвета -->
                <av-field-group label="Цвета" [collapsible]="true">
                  <div class="control-item">
                    <av-picker
                      avTitle="Фон кнопки"
                      [(selectedColor)]="pgColor"
                      [showInput]="true"
                      [allowTransparent]="true"
                    ></av-picker>
                  </div>
                  <div class="control-item">
                    <av-picker
                      avTitle="Цвет текста"
                      [(selectedColor)]="pgTextColor"
                      [showInput]="true"
                      [allowTransparent]="true"
                    ></av-picker>
                  </div>
                </av-field-group>

                <!-- Иконка (ADVANCED CONTROL) -->
                <av-field-group label="Иконка (Advanced)" [collapsible]="true">
                  <div class="control-item">
                    <label>Выбор иконки:</label>
                    <nz-select
                      [ngModel]="pgIcon()"
                      (ngModelChange)="pgIcon.set($event)"
                      nzShowSearch
                      nzAllowClear
                      nzPlaceHolder="Без иконки"
                      style="width: 100%"
                    >
                      @for (preset of iconPresets; track preset.value) {
                      <nz-option nzCustomContent [nzValue]="preset.value" [nzLabel]="preset.label">
                        <div style="display: flex; align-items: center; gap: 8px">
                          <av-icon [type]="preset.value" [size]="16"></av-icon>
                          <span>{{ preset.label }}</span>
                        </div>
                      </nz-option>
                      }
                    </nz-select>
                  </div>

                  @if (pgIcon()) {
                  <div nz-row [nzGutter]="8" style="margin-top: 12px">
                    <div nz-col [nzSpan]="12">
                      <div class="control-item">
                        <label>Размер ({{ pgIconSize() }}px):</label>
                        <nz-slider
                          [nzMin]="8"
                          [nzMax]="64"
                          [ngModel]="pgIconSize()"
                          (ngModelChange)="pgIconSize.set($event)"
                        ></nz-slider>
                      </div>
                    </div>
                    <div nz-col [nzSpan]="12">
                      <av-picker avTitle="Цвет иконки" [(selectedColor)]="pgIconColor"></av-picker>
                    </div>
                  </div>

                  <av-field-group label="Трансформации" size="small" [collapsible]="true">
                    <div nz-row [nzGutter]="8">
                      <div nz-col [nzSpan]="12">
                        <label style="font-size: 10px">Поворот ({{ pgIconRotation() }}°)</label>
                        <nz-slider
                          [nzMin]="0"
                          [nzMax]="360"
                          [nzStep]="15"
                          [ngModel]="pgIconRotation()"
                          (ngModelChange)="pgIconRotation.set($event)"
                        ></nz-slider>
                      </div>
                      <div nz-col [nzSpan]="12">
                        <label style="font-size: 10px">Масштаб ({{ pgIconScale() }})</label>
                        <nz-slider
                          [nzMin]="0.1"
                          [nzMax]="3"
                          [nzStep]="0.1"
                          [ngModel]="pgIconScale()"
                          (ngModelChange)="pgIconScale.set($event)"
                        ></nz-slider>
                      </div>
                    </div>
                    <div nz-row [nzGutter]="8" nzAlign="middle">
                      <div nz-col [nzSpan]="12">
                        <div style="display: flex; flex-direction: column; gap: 4px">
                          <div style="display: flex; align-items: center; justify-content: space-between">
                            <span style="font-size: 10px">Flip X</span>
                            <nz-switch
                              [ngModel]="pgIconFlipX()"
                              (ngModelChange)="pgIconFlipX.set($event)"
                              nzSize="small"
                            ></nz-switch>
                          </div>
                          <div style="display: flex; align-items: center; justify-content: space-between">
                            <span style="font-size: 10px">Flip Y</span>
                            <nz-switch
                              [ngModel]="pgIconFlipY()"
                              (ngModelChange)="pgIconFlipY.set($event)"
                              nzSize="small"
                            ></nz-switch>
                          </div>
                        </div>
                      </div>
                      <div nz-col [nzSpan]="12">
                        <label style="font-size: 10px">Опасити ({{ pgIconOpacity() }})</label>
                        <nz-slider
                          [nzMin]="0.1"
                          [nzMax]="1"
                          [nzStep]="0.1"
                          [ngModel]="pgIconOpacity()"
                          (ngModelChange)="pgIconOpacity.set($event)"
                        ></nz-slider>
                      </div>
                    </div>
                  </av-field-group>

                  <av-field-group label="Стиль и Граница" size="small" [collapsible]="true">
                    <av-picker
                      avTitle="Фон иконки"
                      [(selectedColor)]="pgIconBackground"
                      [allowTransparent]="true"
                    ></av-picker>
                    <div nz-row [nzGutter]="8" style="margin-top: 8px" nzAlign="middle">
                      <div nz-col [nzSpan]="12">
                        <label style="font-size: 10px">Padding: {{ pgIconPadding() }}px</label>
                        <nz-slider
                          [nzMin]="0"
                          [nzMax]="24"
                          [ngModel]="pgIconPadding()"
                          (ngModelChange)="pgIconPadding.set($event)"
                        ></nz-slider>
                      </div>
                      <div nz-col [nzSpan]="12">
                        <div style="display: flex; align-items: center; justify-content: space-between">
                          <span style="font-size: 10px">Граница</span>
                          <nz-switch
                            [ngModel]="pgIconBorderShow()"
                            (ngModelChange)="pgIconBorderShow.set($event)"
                            nzSize="small"
                          ></nz-switch>
                        </div>
                      </div>
                    </div>
                    @if (pgIconBorderShow()) {
                    <div style="margin-top: 8px; padding: 4px; border: 1px dashed #ddd; border-radius: 4px">
                      <av-picker avTitle="Цвет границы" [(selectedColor)]="pgIconBorderColor"></av-picker>
                      <div nz-row [nzGutter]="8" style="margin-top: 4px">
                        <div nz-col [nzSpan]="12">
                          <label style="font-size: 10px">W: {{ pgIconBorderWidth() }}px</label>
                          <nz-slider
                            [nzMin]="1"
                            [nzMax]="5"
                            [ngModel]="pgIconBorderWidth()"
                            (ngModelChange)="pgIconBorderWidth.set($event)"
                          ></nz-slider>
                        </div>
                        <div nz-col [nzSpan]="12">
                          <label style="font-size: 10px">R: {{ pgIconBorderRadius() }}px</label>
                          <nz-slider
                            [nzMin]="0"
                            [nzMax]="25"
                            [ngModel]="pgIconBorderRadius()"
                            (ngModelChange)="pgIconBorderRadius.set($event)"
                          ></nz-slider>
                        </div>
                      </div>
                    </div>
                    }
                  </av-field-group>
                  }
                </av-field-group>
              </div>
            </nz-card>
          </div>

          <!-- Right: Preview & Code -->
          <div nz-col [nzXs]="24" [nzLg]="12">
            <nz-card nzTitle="Результат" class="result-card" style="margin-bottom: 24px">
              <div
                style="
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  padding: 80px 32px;
                  background: #fafafa;
                  border-radius: 12px;
                  border: 1px dashed #d9d9d9;
                  min-height: 200px;
                "
              >
                <button
                  av-button
                  [avType]="pgType()"
                  [avSize]="safePgSize()"
                  [avShape]="pgShape()"
                  [avColor]="pgColor()"
                  [avTextColor]="pgTextColor()"
                  [avIconColor]="pgIconColor()"
                  [avLoading]="pgLoading()"
                  [avBlock]="pgBlock()"
                  [avVisible]="pgVisible()"
                  [avWidth]="pgWidth()"
                  [avHeight]="pgHeight()"
                  [avRadius]="pgRadius()"
                  [avIconSize]="pgIconSize()"
                >
                  @if (pgIcon()) {
                  <av-icon
                    [type]="pgIcon()!"
                    [size]="pgIconSize()"
                    [color]="pgIconColor()"
                    [rotation]="pgIconRotation()"
                    [scale]="pgIconScale()"
                    [opacity]="pgIconOpacity()"
                    [flipX]="pgIconFlipX()"
                    [flipY]="pgIconFlipY()"
                    [padding]="pgIconPadding()"
                    [background]="pgIconBackground()"
                    [border]="pgIconBorderShow() ? pgIconBorderWidth() + 'px solid ' + pgIconBorderColor() : null"
                    [radius]="pgIconBorderRadius()"
                  ></av-icon>
                  @if (pgLabel()) {
                  <span style="margin-left: 8px">{{ pgLabel() }}</span>
                  } } @else {
                  {{ pgLabel() }}
                  }
                </button>
              </div>
            </nz-card>

            <av-help-copy-container
              title="Сгенерированный код"
              [content]="pgGeneratedCode()"
              [defaultCollapsed]="false"
              bgColor="#1e293b"
            ></av-help-copy-container>
          </div>
        </div>
      </div>
      }
    </div>

    <!-- Sections 3-5 Placeholder Content -->
    <div class="ui-help-section">
      <div class="section-header">
        <button class="collapse-toggle" (click)="toggleSection3()">
          <av-icon
            [type]="isSection3Visible() ? 'arrows/av_chevron-up' : 'arrows/av_chevron-down'"
            [size]="20"
          ></av-icon>
        </button>
        <h2>{{ section3Title() }}</h2>
      </div>
      @if (isSection3Visible()) {
      <div class="section-content">
        <div class="content-block">
          <div class="block-placeholder">{{ placeholderText1() }}</div>
        </div>
      </div>
      }
    </div>

    <div class="ui-help-section">
      <div class="section-header">
        <button class="collapse-toggle" (click)="toggleSection4()">
          <av-icon
            [type]="isSection4Visible() ? 'arrows/av_chevron-up' : 'arrows/av_chevron-down'"
            [size]="20"
          ></av-icon>
        </button>
        <h2>{{ section4Title() }}</h2>
      </div>
      @if (isSection4Visible()) {
      <div class="section-content">
        <div class="content-block">
          <div class="block-placeholder">{{ placeholderText2() }}</div>
        </div>
      </div>
      }
    </div>

    <div class="ui-help-section">
      <div class="section-header">
        <button class="collapse-toggle" (click)="toggleSection5()">
          <av-icon
            [type]="isSection5Visible() ? 'arrows/av_chevron-up' : 'arrows/av_chevron-down'"
            [size]="20"
          ></av-icon>
        </button>
        <h2>{{ section5Title() }}</h2>
      </div>
      @if (isSection5Visible()) {
      <div class="section-content">
        <div class="content-block">
          <div class="block-placeholder">{{ placeholderText3() }}</div>
        </div>
      </div>
      }
    </div>
  </div>
</div>
